# 将页面DOM元素转化为canvas

Created: September 14, 2021 7:23 PM
标签: JS, canvas, html2canvas

```jsx
// 获取想要转换的DOM节点
      const poster = this.$refs['poster_view']
      // DOM 节点计算后宽高
      const { width, height } = poster.getBoundingClientRect()
      // 获取像素比
      const dpr = window.devicePixelRatio || 1
      // 创建自定义 canvas 元素
      const canvas = document.createElement('canvas')
      // 设定 canvas 元素属性宽高为 DOM 节点宽高 * 像素比
      canvas.width = width * dpr
      canvas.height = height * dpr
      // 设定 canvas css宽高为 DOM 节点宽高(二选一即可)
      canvas.style.width = `${width}px`
      canvas.style.height = `${height}px`
      // 获取画笔
      const context = canvas.getContext('2d')
			// 使用css像素对坐标系统进行规范化。  
      context.scale(dpr, dpr)
      // 开始将DOM 绘制成 canvas 并以图片的形式下载
      html2canvas(poster, {canvas}).then((canvas) => {
        let dataUrl = canvas.toDataURL('image/png', 1.0)
        let a = document.createElement('a')
        let event = new MouseEvent('click')
        a.download = name || '海报'
        a.href = dataUrl
        a.dispatchEvent(event)
      })
```