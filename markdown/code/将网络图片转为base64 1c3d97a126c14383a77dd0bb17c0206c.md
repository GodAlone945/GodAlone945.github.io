# 将网络图片转为base64

Created: November 25, 2021 3:07 PM
标签: JS, base64, 图片

```jsx
// url: 网络图片地址
//allback: 回调函数，携带base64图片地址
function drawBase64Image(url, callback, outputFormat) {
  var canvas = document.createElement('canvas'),
        ctx = canvas.getContext('2d'),
        img = new Image;
  img.crossOrigin = 'Anonymous';//它开启了本地的跨域允许。当然服务器存储那边也要开放相应的权限才行，如果是设置了防盗链的图片在服务端就没有相应的权限的话你本地端开启了权限也是没有用的
  img.onload = function(){
    canvas.height = img.height;
    canvas.width = img.width;
    ctx.drawImage(img,0,0);
    var dataURL = canvas.toDataURL(outputFormat || 'image/png');//没权限的跨域图片在使用canvas.toDataURL()数据导出时会报错
    callback.call(this, dataURL);
    canvas = null;
  };
  img.src = url;
}

// 调用
drawBase64Image(url, (base64Img) => {
	this.url = base64Img
})
```